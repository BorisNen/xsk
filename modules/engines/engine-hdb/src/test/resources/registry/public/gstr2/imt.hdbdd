namespace gstr2;

@Schema: 'LEARNING'

context imt {


        define view employee_view as
              select from employee as e
              left join "talent_imt_so_header" as H
                  	        On H."SO_ID" = e."ScheduledOfferingID"
              {
                 "e"."USER_ID" as "userID",
                 "e"."EMP_NAME" as "empName",
                 "e"."EMP_LOCATION" as "empLoc",
                 COALESCE(H."SO_ID",e."ScheduledOfferingID") as "SO_ID",
                  "e"."NOTACTIVE" as "NOTACTIVE",
                  COALESCE(H."DELIVERY_METHOD",e."DeliveryMethod") as "DELIVERY_METHOD",
                	"e"."TIMEZONE_ID" as "TIMEZONE_ID",
                	"H"."TIMEZONE_ID_DISP" as "TIMEZONE_ID_DISP",
                	Case when H."SO_ID" is null then 'no'
                         else 'yes'
                    End as "Flag"
              }
              where e."USER_ID" = 'test'


};